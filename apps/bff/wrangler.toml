name = "spirom-bff"
main = "build/worker/shim.mjs"
compatibility_date = "2024-01-01"

[build]
command = "cargo install -q worker-build && worker-build --release"

[vars]
ENVIRONMENT = "production"
API_BASE_URL = "https://api.spirom.com"
SANITY_PROJECT_ID = ""
SANITY_DATASET = "production"
SITE_URL = "https://spirom.com"

# KV Namespaces
[[kv_namespaces]]
binding = "CACHE"
id = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
preview_id = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"

[[kv_namespaces]]
binding = "RATE_LIMIT"
id = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
preview_id = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"

# R2 Buckets
[[r2_buckets]]
binding = "ASSETS"
bucket_name = "spirom-assets"

# Secrets (set via wrangler secret put)
# - API_SECRET_KEY
# - SANITY_TOKEN

[env.staging]
name = "spirom-bff-staging"
vars = { ENVIRONMENT = "staging", API_BASE_URL = "https://api-staging.spirom.com" }

[env.development]
name = "spirom-bff-dev"
vars = { ENVIRONMENT = "development", API_BASE_URL = "http://localhost:3001" }
