SEO特化型ECサイト

バージョン: 2.0 作成日: 2025年12月4日 目的: 本書は、AI開発エージェントが「完璧なドメインパワーを持つECサイト」を自律的に実装するために必要な機能要件を、実装可能な粒度で定義する。




1. グローバル要件 (Global Requirements)




GR-01: 技術スタックの遵守

•
説明: 全ての実装は、以下の技術スタックに従うこと。

•
スタック詳細:

•
CDN / Edge: Cloudflare (Pages, Workers, R2, Argo)

•
フロントエンド: Next.js 15 (App Router)

•
バックエンドAPI (EC): Rust (Axum Framework)

•
データベース (EC): Supabase (PostgreSQL)
  - 選定理由: 無料枠あり、認証・ストレージ機能内蔵、SQLベースで学習コスト低、SEOに影響なし
  - Free枠: 500MB、5万行
  - Pro: $25/月（必要時にスケール）

•
決済BaaS: （未定、インターフェースを定義）

•
ブログCMS: Sanity.io








GR-02: コードリポジトリの初期化

•
説明: GitHub上にモノレポ構成でプロジェクトを初期化する。

•
ディレクトリ構造:

Plain Text


/
├── apps/
│   ├── web/      # Next.js フロントエンド
│   └── api/      # Rust バックエンド
├── packages/
│   └── ui/       # 共有UIコンポーネント
└── sanity/
    └── studio/   # Sanity Studio









2. バックエンド要件 (Rust / Axum API)

（EC関連のバックエンド要件は変更なし）




3. Sanity.io 要件 (ブログCMS)




SAN-01: Sanityプロジェクトの初期化

•
説明: Sanity.ioで新規プロジェクトを作成し、Next.jsアプリと接続する。






SAN-02: ブログ記事スキーマの定義

•
説明: Sanity Studioでブログ記事のコンテンツモデル（スキーマ）を定義する。

•
ファイル: sanity/studio/schemas/post.ts

•
フィールド:

•
title (string, required): 記事タイトル

•
slug (slug, required, source: 'title'): URLスラッグ

•
mainImage (image, required): メイン画像

•
publishedAt (datetime, required): 公開日

•
author (reference, to: [author]): 著者

•
category (reference, to: [category]): カテゴリ

•
body (blockContent): 記事本文

•
seoTitle (string): SEO用タイトル

•
seoDescription (string): SEO用ディスクリプション








SAN-03: 著者・カテゴリのスキーマ定義

•
説明: 著者とカテゴリのスキーマを定義する。






SAN-04: Sanity Studioのカスタマイズ

•
説明: Sanity StudioのUIをカスタマイズし、編集体験を向上させる。






4. フロントエンド要件 (Next.js 15)

4.1. Sanityクライアントのセットアップ




FE-SAN-01: Sanityクライアントの初期化

•
説明: @sanity/client を使用して、Sanityプロジェクトに接続するためのクライアントを初期化する。

•
GROQクエリ: 全てのデータ取得はGROQを使用する。



4.2. ブログ一覧ページ




FE-BLOG-01: ページ生成

•
パス: /blog

•
レンダリング戦略: SSG (Static Site Generation)。ビルド時に生成。






FE-BLOG-02: データ取得

•
説明: getStaticProps内でSanityクライアントを使用し、公開済みのブログ記事一覧をGROQで取得する。

•
GROQクエリ例:

Plain Text


*[_type == "post" && publishedAt < now()] | order(publishedAt desc)









FE-BLOG-03: セマンティックHTML

•
説明: 技術仕様書に準拠したセマンティックなHTML構造で実装する。

•
主要タグ: main, h1, article, h2 (記事タイトル)



4.3. ブログ詳細ページ




FE-POST-01: ページ生成

•
パス: /blog/{slug}

•
レンダリング戦略: SSG with ISR (Incremental Static Regeneration)。

•
getStaticPathsで主要な記事をビルド時に生成。

•
fallback: 'blocking' を設定。

•
revalidate: 60 (1分) を設定し、記事更新を迅速に反映。








FE-POST-02: データ取得

•
説明: getStaticProps内でSanityクライアントを使用し、特定のスラッグを持つ記事データをGROQで取得する。






FE-POST-03: セマンティックHTML

•
説明: 記事本文（Block Content）をHTMLに変換して表示する。@portabletext/react を使用。

•
主要タグ: main, article, h1, time[datetime] (公開日)






FE-POST-04: 構造化データ (JSON-LD)

•
説明: generateMetadata内で、Articleタイプの構造化データを動的に生成する。

•
必須プロパティ: headline, image, datePublished, dateModified, author



4.4. SEO特化要件の更新




FE-SEO-01: sitemap.xml の自動生成（更新）

•
説明: ブログ記事のURLもsitemap.xmlに含めるように更新する。






FE-SEO-02: robots.txt の設定（変更なし）

（その他のフロントエンド要件は変更なし）




5. インフラ要件 (Cloudflare)




INF-05: Sanity Webhookの設定

•
説明: Sanityでコンテンツが更新された際に、Next.jsのISRをトリガーするためのWebhookを設定する。

•
トリガー: create, update, delete

•
ターゲット: Next.jsの再検証用APIルート



